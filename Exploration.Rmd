---
title: "R Notebook"
output: html_notebook
---

## Introduction

For much of human existence, child berth has been an extraordinarily risky endeavor, often ending with the death of either the mother or baby. With the advent of modern medicine and technology, much of the world has seen a significant reduction in the rate of child berth related deaths and of child deaths. While this is something to applaud, there is still much work to be done. Child development after berth is a crucial period during which many of the neurological and motor skills necessary for a full and healthy life ossify. Anything parents can do to increase the healthiness of the baby in this period could have substantial effeccdts on a baby's health. One avenue that might have a positive impact is during the actual pregnancy. Some women engage in prenatal activities that may be risky and others engage in prenatal activities that might be salubrious. In this study, We seek to determine whether prenatal care has an effect on the health of a newborn.


```{r setup}
library(car)
```


**Variable Descriptions:**

```{r load}
load("bwght_w203.RData")
desc
```


**Data Quality Assessment**
```{r}
# First we want to determine whether there are missing data. If there are, we will then want to determine whether
# there is a pattern to those missing data.

apply(data, 2, function(x) mean(is.na(x)))
```

The apply function shows that for many of the variables we are not missing any data, while there are several variables on which we are missing some data. The fact that the average number of drinks per night or cigarrettes per week variable has the most missing data could indicate that many mothers who did consume alcohol during their pregnacy refused to answer. This could potentially lead to nonresponse bias.  The omaps and fmaps variables have the exact same number of missing data. If this happens on the same observation, then we might have hospital bias. Some hospitals might not do these measurements. There is also a very high percentage of missing data from the same people on the smoking and drinking quesiton.


**Exploratory Analysis of each variable:**

- mage

```{r mage}
hist(data$mage)
summary(data$mage)
```

Nothing out of ordinary. Normal distribution. No transformation required

- meduc

```{r meduc}
hist(data$meduc)
summary(data$meduc)
```

Atypical distribution, with spikes probably due to education milestones. Probably could transform to indicator or categorical variable.

- monpre

```{r monpre}
hist(data$monpre)
summary(data$monpre)
```

What does zero mean? Should we take it out?

- npvis 

```{r npvis}
hist(data$npvis, breaks = 40)
summary(data$npvis)
```

Somewhat normal. Peak at around 11 (monthly visits?)

- fage

```{r fage}
hist(data$fage, breaks = 40)
summary(data$fage)
```

Nothing out of ordinary. Normal distribution, slight positive skew. No transformation required

- meduc

```{r feduc}
hist(data$feduc)
summary(data$feduc)
```

Atypical distribution, with spikes probably due to education milestones. Probably could transform to indicator or categorical variable.

- bwght

```{r bwght}
hist(data$bwght, breaks = 50)
summary(data$bwght)
```

Normal, negative skew. No transformation required, but log-transform could make practical sense.

- omaps

```{r omaps}
hist(data$omaps)
summary(data$omaps)
```

One to ten scale, not continuous, does not make much sense.

-fmaps

```{r fmaps}
hist(data$fmaps)
summary(data$fmaps)
```

One to ten scale, not continuous, does not make much sense.

- cigs

```{r cigs}
hist(data$cigs, breaks = 40)
hist(data$cigs[data$cigs > 0], breaks = 40)
summary(data$cigs)
```

Weird distribution, with a few spikes at marked points due to survey answer round-ups or round-downs. Lots and lots of zeroes. Perhaps change to indicator or categorial variable?

- drink

```{r drink}
hist(data$drink)
hist(data$drink[data$drink > 0], breaks = 40)
summary(data$drink)
```

Lots and lots of zeroes, just like cigs. Perhaps transform to indicator or categorical variable.

- male

```{r male}
hist(data$male)
summary(data$male)
```

Approximately equal sample distribution.

- male

```{r mwhte}
hist(data$mwhte)
summary(data$mwhte)
```

Uneven, mostly white mothers.

Verify correlation of every variable:

```{r scatterplotmatrix}
scatterplotMatrix(~ bwght + mage + meduc + monpre + npvis + fage + feduc + cigs + drink, data=data)
scatterplotMatrix(~ bwght + omaps + fmaps + male + mwhte + mblck + moth + fwhte + fblck + foth, data=data)
```

Bivariate Plots

```{r}
ggplot(data = data, aes(x = data$monpre, y = data$bwght)) + geom_point() + geom_smooth(method = "loess") # This strongly suggests that the month at which you start prenatal care has no impact on the birthweight of the baby.

ggplot(data = data, aes(x = data$npvis, y = data$bwght)) + geom_point() + geom_smooth(method = "loess") # serious outliers towards the lower left of the plot, but these will be outweighed by the many other variables whose x values are the same. There are scarly any data beyond 20 npvis. There seems to be a small positive effect to having over 5 visits.
```

